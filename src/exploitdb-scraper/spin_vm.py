# -*- coding: utf-8 -*-

"""
Runs vagrant up if it detects a machine in the expected directory.

TODO: Get the Scenario and VM names from the Json File
TODO: Probably gets the scenario path from the Json file, check for that
"""
import os

class SpinVM():
    
    def __init__(self, scenario_name, vm_name):
        self.scenario_name = scenario_name
        self.vm_name = vm_name
        
#    @app.route('/boxes/all')
#    def 
    
    def runVagrantUp(self):
        mydir = os.getcwd() # would be the same path as .py
        mydir = mydir.rsplit("\\", 1)[0] #move up a directory

        vm_location = mydir+"/scenarios/"+self.scenario_name+"/Machines/"
        
        if not os.path.exists(vm_location): # Proceed if path exists
            return
        
        os.chdir(vm_location)

#        
        isFile = os.path.isfile(vm_location+"/"+self.vm_name) 
        
        if not isFile: # Proceed if file is available
            return
        
        bashCommand = "dir"
        
#        subprocess.Popen("dir")
#        process = subprocess.Popen(bashCommand.split(), stdout=subprocess.PIPE)
#        output, error = process.communicate()
        output = os.popen(bashCommand).read()
        
        print(output)

test = SpinVM("Scenario_4", "sample_vm.txt") 
test.runVagrantUp()